

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Stages</title>
    <link rel="stylesheet" type="text/css" href="../../css/main.css">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
  </head>
  <body>
    <section class="docs">
      <aside>

        <div class="logoContainer">
          <a href="/">
            <img src="../../images/logo.svg" class="logo" />
            Piscosour
          </a>

        </div>
        <ul class="main_menu">
          
            
            <li>
              <h4>General</h4>
              
                
                  
                    <a href="../../developers/what_is_piscosour.html">What is piscosour</a>
                  
                
              
                
                  
                    <a href="../../developers/get_started.html">Get started</a>
                  
                
              
                
              
                
              
                
              
            </li>

            <li>
              <h4>Guides</h4>
              <ul>
              
                
              
                
              
                
              
                
                  
                  <li>
                    
                    <a href="../../developers/guides/01-contexts.html">Contexts</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/02-steps.html">Steps</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/03-flows.html">Flows</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/04-stages.html" class="selected">Stages</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/05-parameters.html">Parameters</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/06-inquire.html">Inquire</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/07-plugins.html">Plugins</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/08-parameters_between_steps.html">Communication between steps</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/09-steps-advanced.html">Advanced features in steps</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/10-requirements.html">Requirements</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/11-configuration.html">Recipe Configuration</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/12-guidelines.html">Guidelines</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/13-analytics.html">Google Analytics Integration</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/14-logger.html">Logger</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/15-implementations.html">Implementations</a>
                    
                  </li>
                  
                
              
                
              
              </ul>
            </li>

            <li>
              <h4>Tutorials</h4>
              <ul>
              
                
              
                
              
                
              
                
              
                
                  
                  <li>
                    
                    <a href="../../developers/tutorials/pisco-website.html">Create WebSite Recipe</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/tutorials/img-empty-submenu.png"></a>
                    
                  </li>
                  
                
              
              </ul>
            </li>

            
            <li>
              <h4>Plugins</h4>
              <ul>
                
                  
                
                  
                
                  
                    
                    <li>
                      
                      <a href="../../developers/documents/context.html">context</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/fsutils.html">fsutils</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/inquirer.html">inquirer</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/installer.html">installer</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/launcher.html">launcher</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/os.html">os</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/piscosour.html">piscosour</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/skipper.html">skipper</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/stream-write-hook.html">stream-write-hook</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/system-checker.html">system-checker</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/system-saver.html">system-saver</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/test.html">test</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/userConfig.html">userConfig</a>
                      
                    </li>
                    
                  
                
                  
                
                  
                
              </ul>
            </li>
            
            
          
            
          
            
          
            
          
        </ul>

        
          
        
          
        
          
        
          
          <a href="../../users/get_started.html"
            class="switch_target">
            Docs for users
          </a>
          
        
      </aside>
      <article>
        <h1 id="stages">Stages</h1>
<p>In a <a href="./02-steps.html">step</a>, the <code>index.js</code> file implements the flow. The <a href="./02-steps.md#scaffold">scaffold</a> generates a file like this:</p>
<pre><code class="lang-javascript">&#39;use strict&#39;;

module.exports = {
  check: function() {
    this.logger.info(&#39;#blue&#39;, &#39;Check if all you need to execute this step exists&#39;);
  },

  config: function() {
    this.logger.info(&#39;#yellow&#39;, &#39;Config the step to run&#39;);
  },

  run: function(ok, ko) {
    this.sh(&#39;echo Run main execution of the step&#39;, ko, true);
  },

  prove: function() {
    this.logger.info(&#39;#green&#39;, &#39;Check if the step has run ok&#39;);
  },

  notify: function() {
    this.logger.info(&#39;#grey&#39;, &#39;Notify the end of the shot to someone or something&#39;);
  },

  emit: function() {
    this.logger.info(&#39;#white&#39;, &#39;Emit the result of the step to other steps. Allow communication between steps&#39;);
    return { message: &#39;emit a message&#39; };
  }
};
</code></pre>
<p>And the stages of a <a href="./02-steps.html">step</a> by default are:</p>
<ol>
<li><code>check</code>: check if all you need to execute this <a href="./02-steps.html">step</a> exists.</li>
<li><code>config</code>: config the <a href="./02-steps.html">step</a> to run.</li>
<li><code>run</code>: run main execution of the <a href="./02-steps.html">step</a>.</li>
<li><code>prove</code>: check if the <a href="./02-steps.html">step</a> has run ok.</li>
<li><code>notify</code>: notify the end of the step to someone or something.</li>
<li><code>emit</code>: emit the result of the <a href="./02-steps.html">step</a> to other steps. Allow communication between steps.</li>
</ol>
<h2 id="promises">Promises</h2>
<p>Note that all the stages are <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">promises</a> functions, they has two optional paramenter &#39;resolve&#39;, &#39;reject&#39;;</p>
<p>A example with <code>resolve</code> and <code>reject</code>:</p>
<pre><code class="lang-javascript">module.exports = {
  run: function(resolve, reject) {
    if (this.params.jsonIsWellFormed) {
      resolve();
    } else {
      reject();
    }
    return;
  }
};
</code></pre>
<h2 id="-check-stage"><code>check</code> stage</h2>
<p>Check if all you need to execute this <a href="./02-steps.html">step</a> exists. Here you can see some examples:</p>
<ul>
<li>System requirement. But check first <a href="./10-requirements.html">requirements</a> configuration options.</li>
<li>Maybe check if some inputs are all well formed. For example a json well formed.</li>
<li>Or check if the environment has a global variable setted.</li>
<li>...</li>
</ul>
<h2 id="-config-stage"><code>config</code> stage</h2>
<p>Config the <a href="./02-steps.html">step</a> to run. Do you need to config something, this is the stage to do it.</p>
<h2 id="-run-stage"><code>run</code> stage</h2>
<p>Run main execution of the <a href="./02-steps.html">step</a>. This stage hope that all that it need to implement a process is &#39;ok&#39;, because it has been provide by the above stage.</p>
<h2 id="-prove-stage"><code>prove</code> stage</h2>
<p>Check if the <a href="./02-steps.html">step</a> has run ok.</p>
<ul>
<li>If artifacts has been well built.</li>
<li>or if there is a inexpected file created.</li>
</ul>
<h2 id="-notify-stage"><code>notify</code> stage</h2>
<p>Notify the end of the shot to someone or something.</p>
<ul>
<li>Email to an address.</li>
<li>Notify to a slack channel.</li>
<li>...</li>
</ul>
<h2 id="-emit-stage"><code>emit</code> stage</h2>
<p>Emit the result of the <a href="./02-steps.html">step</a> to other steps. Allow communication between steps.</p>
<p>See <a href="./08-parameters_between_steps.html">parameters between steps</a> for more information.</p>
<p><code>Note:</code> Stages are configured on piscosour.json file of every recipe, it is possible to overwrite stages parameters on piscosour.json, see <a href="./11-configuration.html">recipe configuration</a> for more information. </p>

      </article>
    </section>
    <script type="text/javascript" src="../../js/highlight.pack.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
      $(function(){
      	$('.toggle_section').on('click', function(ev) {
          $(ev.currentTarget).parent('li').toggleClass('open');
        });
      });

    </script>
  </body>
</html>
