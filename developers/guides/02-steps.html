

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Steps</title>
    <link rel="stylesheet" type="text/css" href="../../css/main.css">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
  </head>
  <body>
    <section class="docs">
      <aside>

        <div class="logoContainer">
          <a href="/">
            <img src="../../images/logo.svg" class="logo" />
            Piscosour
          </a>

        </div>
        <ul class="main_menu">
          
            
            <li>
              <h4>General</h4>
              
                
                  
                    <a href="../../developers/what_is_piscosour.html">What is piscosour</a>
                  
                
              
                
                  
                    <a href="../../developers/get_started.html">Get started</a>
                  
                
              
                
              
                
              
                
              
            </li>

            <li>
              <h4>Guides</h4>
              <ul>
              
                
              
                
              
                
              
                
                  
                  <li>
                    
                    <a href="../../developers/guides/01-contexts.html">Contexts</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/02-steps.html" class="selected">Steps</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/03-flows.html">Flows</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/04-stages.html">Stages</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/05-parameters.html">Parameters</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/06-inquire.html">Inquire</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/07-plugins.html">Plugins</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/08-parameters_between_steps.html">Communication between steps</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/09-steps-advanced.html">Advanced features in steps</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/10-requirements.html">Requirements</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/11-configuration.html">Recipe Configuration</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/12-guidelines.html">Guidelines</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/13-analytics.html">Google Analytics Integration</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/14-logger.html">Logger</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/guides/15-implementations.html">Implementations</a>
                    
                  </li>
                  
                
              
                
              
              </ul>
            </li>

            <li>
              <h4>Tutorials</h4>
              <ul>
              
                
              
                
              
                
              
                
              
                
                  
                  <li>
                    
                    <a href="../../developers/tutorials/pisco-website.html">Create WebSite Recipe</a>
                    
                  </li>
                  
                  <li>
                    
                    <a href="../../developers/tutorials/img-empty-submenu.png"></a>
                    
                  </li>
                  
                
              
              </ul>
            </li>

            
            <li>
              <h4>Plugins</h4>
              <ul>
                
                  
                
                  
                
                  
                    
                    <li>
                      
                      <a href="../../developers/documents/context.html">context</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/fsutils.html">fsutils</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/inquirer.html">inquirer</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/installer.html">installer</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/launcher.html">launcher</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/os.html">os</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/piscosour.html">piscosour</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/skipper.html">skipper</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/stream-write-hook.html">stream-write-hook</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/system-checker.html">system-checker</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/system-saver.html">system-saver</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/test.html">test</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/userConfig.html">userConfig</a>
                      
                    </li>
                    
                  
                
                  
                
                  
                
              </ul>
            </li>
            
            
          
            
          
            
          
            
          
        </ul>

        
          
        
          
        
          
        
          
          <a href="../../users/get_started.html"
            class="switch_target">
            Docs for users
          </a>
          
        
      </aside>
      <article>
        <h1 id="steps">Steps</h1>
<p>Steps often belong to an execution <a href="./03-flows.html">flow</a>, and usually are executed in a <a href="./01-contexts.html">context</a>.</p>
<p>Contexts are implements with three files in the recipe:</p>
<pre><code>-rwxr-xr-x    1 pisco  staff   steps/step-name/config.json
-rwxr-xr-x    1 pisco  staff   steps/step-name/index.js
-rwxr-xr-x    1 pisco  staff   steps/step-name/info.md
</code></pre><p>Where the <code>config.json</code> file has the configuration, <code>info.md</code> explain and document the step, and <code>index.js</code> has the implementation of the step.</p>
<p>Note, it exists a <a href="#scaffold">scaffold generator tool</a></p>
<h2 id="-config-json-configuration"><code>config.json</code> configuration</h2>
<p>The <code>config.json</code> file has the definition of the step.</p>
<p>Example:</p>
<pre><code class="lang-json">{
  &quot;name&quot;: &quot;sayHello&quot;,
  &quot;description&quot;: &quot;Say Hello World&quot;,
  &quot;isGenerator&quot;: false,
  &quot;contexts&quot;: [ &quot;context1&quot;, &quot;context2&quot; ],
  &quot;plugins&quot;: [ &quot;plugin1&quot;, &quot;plugin2&quot; ],
  &quot;prompts&quot;: {},
  &quot;param1&quot;: &quot;value1&quot;,
  &quot;param2&quot;: 2,
  &quot;param3&quot;: { &quot;object1&quot;: &quot;value&quot; }
}
</code></pre>
<p>The <code>config.json</code> file can configure the following fields:</p>
<h3 id="-name-property"><code>name</code> property</h3>
<p>Short name of the step, it must be descriptive and unique.</p>
<ul>
<li>It is mandatory</li>
<li>String type expected</li>
</ul>
<h3 id="-description-property"><code>description</code> property</h3>
<p>It is a short description about the step.</p>
<ul>
<li>It is mandatory</li>
<li>String type expected</li>
</ul>
<h3 id="-isgenerator-property"><code>isGenerator</code> property</h3>
<p>If the steps creates a context, then fill a &#39;true&#39; value. Otherwise &#39;false&#39;.</p>
<ul>
<li>It is optional</li>
<li>The default value is &#39;false&#39;.</li>
<li>Boolean type expected</li>
</ul>
<h3 id="-contexts-property"><code>contexts</code> property</h3>
<p>Array of contexts which step can be executed.</p>
<ul>
<li>It is mandatory.</li>
<li>Array of string expected.</li>
<li>Could be &quot;*&quot; that means that apply for all contexts.</li>
</ul>
<p>Example: <code>&quot;contexts&quot;: [ &quot;context1&quot;, &quot;context2&quot; ]</code></p>
<h3 id="-plugins-property"><code>plugins</code> property</h3>
<p>Array of <a href="./07-plugins.html">plugins</a> injected into the step.</p>
<ul>
<li>It is optional</li>
<li>The default value is an empty array. <code>&quot;plugins&quot;: []</code></li>
</ul>
<p>Example: <code>&quot;plugins&quot;: [ &quot;plugin1&quot;, &quot;plugin2&quot; ]</code></p>
<h3 id="-prompts-property"><code>prompts</code> property</h3>
<p>Array of <a href="./06-inquire.html">inquire prompts</a> of the step.</p>
<ul>
<li>It is optional</li>
<li>The default vulue is an empty array. <code>&quot;prompts&quot;: []</code></li>
</ul>
<p>Example:</p>
<pre><code class="lang-json">{
  &quot;prompts&quot;: [
    {
      &quot;type&quot;: &quot;input&quot;,
      &quot;name&quot;: &quot;param1&quot;,
      &quot;required&quot;: true,
      &quot;default&quot;: &quot;value1&quot;,
      &quot;message&quot;: &quot;Write the param1&quot;
    }, {
      &quot;type&quot;: &quot;confirm&quot;,
      &quot;name&quot;: &quot;param2&quot;,
      &quot;required&quot;: true,
      &quot;message&quot;: &quot;Write the param2&quot;
    }
  ]
}
</code></pre>
<p>See <a href="./06-inquire.html">inquire prompts</a> for more information.</p>
<h3 id="-a-name-paramaters-a-other-customized-params"><a name="paramaters"></a>Other customized params</h3>
<p>And others customized paramaters, see <a href="./05-parameters.html">parameters</a> for more information.</p>
<pre><code class="lang-json">{
  &quot;param1&quot;: &quot;value1&quot;,
  &quot;param2&quot;: &quot;value2&quot;,
  &quot;param3&quot;: &quot;value3&quot;
}
</code></pre>
<p>In the step implementation, parameters are available with <code>this.params</code>.</p>
<p>Example:</p>
<pre><code class="lang-javascript">module.export = {
  run: function() {
    console.log(
      this.params.param1,
      this.params.param2,
      this.params.param3);
  }
}
</code></pre>
<p>This customized paramaters are common to all contexts.</p>
<h2 id="-index-js-implementation"><code>index.js</code> implementation</h2>
<p>The <code>index.js</code> file implements the flow. The <a href="#scaffold">scaffold</a> generates a file like this:</p>
<pre><code class="lang-javascript">module.exports = {
  check: function() {
    this.logger.info(&#39;#blue&#39;, &#39;Check if all you need to execute this step exists&#39;);
  },

  config: function() {
    this.logger.info(&#39;#yellow&#39;, &#39;Config the step to run&#39;);
  },

  run: function(ok, ko) {
    this.sh(&#39;echo Run main execution of the step&#39;, ko, true);
  },

  prove: function() {
    this.logger.info(&#39;#green&#39;, &#39;Check if the step has run ok&#39;);
  },

  notify: function() {
    this.logger.info(&#39;#grey&#39;, &#39;Notify the end of the shot to someone or something&#39;);
  },

  emit: function() {
    this.logger.info(&#39;#white&#39;, &#39;Emit the result of the step to other steps. Allow communication between steps&#39;);
    return { message: &#39;emit a message&#39; };
  }
};
</code></pre>
<p>The stages of a step are used to:</p>
<ol>
<li><code>check</code>: check if all you need to execute this step exists.</li>
<li><code>config</code>: config the step to run.</li>
<li><code>run</code>: run main execution of the step.</li>
<li><code>prove</code>: check if the step has run ok.</li>
<li><code>notify</code>: notify the end of the shot to someone or something.</li>
<li><code>emit</code>: emit the result of the step to other steps. Allow communication between steps. Check <a href="08-parameters_betwwen_steps.html">parameters transmission between steps</a> for more information.</li>
</ol>
<p>Please see <a href="./04-stages.html">stages of a step</a> for more information. And check <a href="./09-steps-advanced.html">advanced step feature</a> to help you how to implement those stages.</p>
<h2 id="documentation">Documentation</h2>
<p>The <code>info.md</code> file just explain the context with a markdown format:</p>
<pre><code class="lang-markdown"># Step step-name

The description about the step.
</code></pre>
<h2 id="-a-name-scaffold-a-scaffold-generator"><a name="scaffold"></a>Scaffold generator</h2>
<p>Pisco provides a scaffold generator. Launch it placed inside your recipe with:</p>
<pre><code class="lang-sh">$ cd your-recipe
$ pisco recipe:add-step
</code></pre>

      </article>
    </section>
    <script type="text/javascript" src="../../js/highlight.pack.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
      $(function(){
      	$('.toggle_section').on('click', function(ev) {
          $(ev.currentTarget).parent('li').toggleClass('open');
        });
      });

    </script>
  </body>
</html>
