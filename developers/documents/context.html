

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>context</title>
    <link rel="stylesheet" type="text/css" href="../../css/main.css">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
  </head>
  <body>
    <section class="docs">
      <aside>

        <div class="logo">
          <a href="/">
            <i class="icon-piscosour"></i>
            Piscosour
          </a>

        </div>
        <ul class="main_menu">
          
            
            <li>
              <h4>General</h4>
              
                
              
                
                  
                    <a href="../../developers/get_started.html">Get started</a>
                  
                
              
                
              
                
              
            </li>

            <li>
              <h4>Guides</h4>
              <ul>
              
                
              
                
              
                
                  
                  <li>
                    
                    <a href="../../developers/guides/packaging.html">Packaging best practices</a>
                    
                  </li>
                  
                
              
                
              
              </ul>
            </li>

            <li>
              <h4>Tutorials</h4>
              <ul>
              
                
              
                
              
                
              
                
                  
                  <li>
                    
                    <a href="../../developers/tutorials/convert_to_recipe.html">Convert to recipe</a>
                    
                  </li>
                  
                
              
              </ul>
            </li>

            
            <li>
              <h4>Plugins</h4>
              <ul>
                
                  
                    
                    <li>
                      
                      <a href="../../developers/documents/context.html" class="selected">context</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/fsutils.html">fsutils</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/inquirer.html">inquirer</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/installer.html">installer</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/launcher.html">launcher</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/os.html">os</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/piscosour.html">piscosour</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/skipper.html">skipper</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/stream-write-hook.html">stream-write-hook</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/system-checker.html">system-checker</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/system-saver.html">system-saver</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/test.html">test</a>
                      
                    </li>
                    
                    <li>
                      
                      <a href="../../developers/documents/userConfig.html">userConfig</a>
                      
                    </li>
                    
                  
                
                  
                
                  
                
                  
                
              </ul>
            </li>
            
            
          
            
          
            
          
            
          
        </ul>

        
          
        
          
        
          
        
          
          <a href="../../users/get_started.html"
            class="switch_target">
            Docs for users
          </a>
          
        
      </aside>
      <article>
        <h1 id="plugins-context">Plugins: context</h1>
<h3 id="context-for-the-pisco-execution">Context for the pisco execution</h3>
<p>With this plugin you can automatically check where recipe was executed. This plugin take configuration from params and expose two method and make one pre-hook check.</p>
<h4 id="how-two-configure-repotype-definitions">How two configure repoType definitions</h4>
<p>You can configure the repoTypes definition in all the configurations files where pisco recipes are configured <a href="doc/Load_Parameters.md">see information for pisco configuration</a>. </p>
<p><strong>Is recommend to use the piscosour.json file of your recipe</strong></p>
<p>The param is called contexts, and must be a Hash with the name of the repoType as key and Array with all the rules the repo must to match.</p>
<p>example of piscosour.json:</p>
<pre><code>    &amp;quot;params&amp;quot;: {
        &amp;quot;contexts&amp;quot;: {
            &amp;quot;node-module&amp;quot;: [
                {
                    &amp;quot;file&amp;quot;: &amp;quot;package.json&amp;quot;,
                    &amp;quot;conditions&amp;quot;: [
                        &amp;quot;that.version&amp;quot;
                    ]
                },
                {
                    &amp;quot;file&amp;quot;: &amp;quot;piscosour.json&amp;quot;,
                    &amp;quot;noexists&amp;quot;: &amp;quot;true&amp;quot;
                }
            ],
            &amp;quot;recipe&amp;quot;: [
                {
                    &amp;quot;sufficient&amp;quot;: true,
                    &amp;quot;file&amp;quot;: &amp;quot;.piscosour/piscosour.json&amp;quot;,
                    &amp;quot;conditions&amp;quot;: [
                        &amp;quot;that.repoType===&amp;#39;recipe&amp;#39;&amp;quot;
                    ]
                },
                {
                    &amp;quot;file&amp;quot;: &amp;quot;package.json&amp;quot;,
                    &amp;quot;conditions&amp;quot;: [
                        &amp;quot;that.keywords.indexOf(&amp;#39;piscosour-recipe&amp;#39;)&amp;gt;=0&amp;quot;
                    ]
                },
                {
                    &amp;quot;file&amp;quot;: &amp;quot;piscosour.json&amp;quot;
                }
            ]
        }
    },
</code></pre><p><strong>Rules:</strong></p>
<p>Define all rules that a repoType must match. All rules not sufficient must to be satisfied.</p>
<ul>
<li><strong>file:</strong> The path of the file relative to the root of the repoType. (for exemple: package.json for a node-module)</li>
<li><strong>sufficient:</strong> If this rule is matched the rest of the rules are ignored. If is not matched, the rule is ignored and the rest of rules are evaluated (default: false)</li>
<li><strong>noexist:</strong> Check if the file is <strong>not</strong> present. (default: false)</li>
<li><strong>conditions:</strong> Is an array with all the conditions that the file must to match. <ol>
<li>The file must to be a correct json file.</li>
<li><strong>that</strong> is the instance of the json object.</li>
<li>write one condition per element in your array. </li>
<li>The conditions were evaluated using javascript.</li>
</ol>
</li>
</ul>
<h4 id="pre-hook-check-one-shot-is-executed-in-the-root-of-any-repository-type-">Pre-hook: Check one shot is executed in the root of any repository type.</h4>
<p>By default, the shot behaviour is assume that repoType is mandatory, if you need to execute one shot without this check of context, use <strong>contextFree</strong> parameter. <strong>contextFree</strong> usually is used for shotd like &quot;create&quot; or something like that.  </p>
<p>only parametrized in params.json:</p>
<pre><code>{
 [...]
  &amp;quot;contextFree&amp;quot; : true
}
</code></pre><p>A user command (straw) only could be contextFree if all of its shots are contextFree. If only one shot of a straw is not contextFree then the context will be checked.</p>
<p><strong>Disable this check using options in the command line</strong>: Is possible to disable this check using this option in the command line: <strong>--b-disableContextCheck</strong>. Usefull for system requirements checks.</p>
<h4 id="addon-this-ctxis">addon: this.ctxIs</h4>
<table>
<thead>
<tr>
<th>Param</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>name of the repoType to test</td>
</tr>
</tbody>
</table>
<p>Use this.ctxIs to ask pisco where was executed.</p>
<pre><code>let isComponent = this.ctxIs(&amp;quot;component&amp;quot;);
</code></pre><p>isComponent must to be true if your recipe was executed in the root of a component.</p>
<h4 id="addon-this-ctxwhoami">addon: this.ctxWhoami</h4>
<p>Ask pisco the repoTypes of the directory where you executed your recipe.</p>
<pre><code>let repos = this.ctxWhoami();
</code></pre><p>repos is an Array of types that match the place where your recipe was executed.</p>

      </article>
    </section>
    <script type="text/javascript" src="../../js/highlight.pack.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
      $(function(){
      	$('.toggle_section').on('click', function(ev) {
          $(ev.currentTarget).parent('li').toggleClass('open');
        });
      });

    </script>
  </body>
</html>
